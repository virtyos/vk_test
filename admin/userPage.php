<?php  require_once('../modules/AppModule.php');  require_once('../modules/AuthModule.php');    require_once('../libs/Templater.php');  $renderParams = array();    require_once('../models/UserModel.php');  require_once('../models/StatUserModel.php');  require_once('../models/SiteModel.php');    $userId = getGetParam('user');  $user = null;  if ($userId) {    $user = \UserModel\select(array('conditions' => 'id = :id', 'params' => array(':id' => $userId)));  }  //if it's no such site  if (!$user) {    throw new Exception('no such user');    die();  }  $user = $user[0];    $renderParams['user'] = $user;    $userStats = \StatUserModel\select(array(    'conditions' => 'id_user = :id_user  AND (date_visit BETWEEN :start_date AND DATE_ADD(:end_date, INTERVAL 1 DAY))',    'params' => array(      ':id_user' => $user['id'],      ':start_date' => date('Y-m-d', (time() - 7*24*3600)),      ':end_date' => date('Y-m-d'),    )  ));    foreach ($userStats as $k => $stat) {    $site = \SiteModel\select(array(      'conditions' => 'id = :id',      'params' => array(':id' => $stat['id_site'])    ));    if ($site) {      $site = $site[0];    }    $userStats[$k]['site'] = $site;  }      $renderParams['userStats'] = $userStats;    tplRender('userPage', $renderParams);  